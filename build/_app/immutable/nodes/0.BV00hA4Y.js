import{f as z,a as p,d as we,t as At}from"../chunks/BDgML0BG.js";import{h as ts,a as ss,as,z as S,o as he,at as Ce,v as o,w as oe,k as R,j as e,au as Ke,I as W,t as _e,x as c,y as l,J as b,g as me,q as Xe,_ as rs,f as os,ag as re,av as ns,ae as Y,aw as is}from"../chunks/ZjNQrdaN.js";import{s as F,e as Te,d as Lt,a as ls}from"../chunks/eaQsrxS5.js";import{l as cs,t as Ct,m as ds,o as vs,p as us,h as Ee,q as fs,r as lt,k as Pe,i as Dt,v as k,f as Pt,w as gs,c as rt,x as Et,s as H,y as ps,z as ms,j as ws,A as Ge,B as hs,C as ot,D as _s,E as bs,F as ys,G as xs,H as ks,I as zs,J as Ts}from"../chunks/6qSDsJxn.js";import{p as E,i as A,c as nt,b as ct,s as St,a as ze}from"../chunks/CTLQGSEP.js";import{s as Cs,b as ce,g as Mt}from"../chunks/BWqOPg7E.js";import{G as Ps}from"../chunks/dlUFelYR.js";import"../chunks/CF2fgOQ-.js";import{i as Ye}from"../chunks/COHNfflA.js";import{c as dt}from"../chunks/DNHPwvaD.js";function Ot(i,t,s,d,v){var f;ts&&ss();var w=(f=t.$$slots)==null?void 0:f[s],a=!1;w===!0&&(w=t.children,a=!0),w===void 0?v!==null&&v(i):w(i,a?()=>d:d)}const Es=!0,Ns=!1,Is=!0,Ra=Object.freeze(Object.defineProperty({__proto__:null,csr:Is,prerender:Es,ssr:Ns},Symbol.toStringTag,{value:"Module"}));function As(i,t,s){const{reverseOrder:d,gutter:v=8,defaultPosition:w}=s||{},a=t.filter(u=>(u.position||w)===(i.position||w)&&u.height),f=a.findIndex(u=>u.id===i.id),g=a.filter((u,x)=>x<f&&u.visible).length;return a.filter(u=>u.visible).slice(...d?[g+1]:[0,g]).reduce((u,x)=>u+(x.height||0)+v,0)}const Ls={startPause(){us(Date.now())},endPause(){vs(Date.now())},updateHeight:(i,t)=>{ds({id:i,height:t})},calculateOffset:As};function Ds(i){const{toasts:t,pausedAt:s}=cs(i),d=new Map;let v;const w=[s.subscribe(a=>{if(a){for(const[,f]of d)clearTimeout(f);d.clear()}v=a}),t.subscribe(a=>{if(v)return;const f=Date.now();for(const g of a){if(d.has(g.id)||g.duration===1/0)continue;const C=(g.duration||0)+g.pauseDuration-(f-g.createdAt);if(C<0)return g.visible&&Ct.dismiss(g.id),null;d.set(g.id,setTimeout(()=>Ct.dismiss(g.id),C))}})];return as(()=>{for(const a of w)a()}),{toasts:t,handlers:Ls}}var Ss=z('<div class="svelte-11kvm4p"></div>');function Ms(i,t){let s=E(t,"primary",8,"#61d345"),d=E(t,"secondary",8,"#fff");var v=Ss();let w;S(()=>w=Ee(v,"",w,{"--primary":s(),"--secondary":d()})),p(i,v)}var Os=z('<div class="svelte-1ee93ns"></div>');function Hs(i,t){let s=E(t,"primary",8,"#ff4b4b"),d=E(t,"secondary",8,"#fff");var v=Os();let w;S(()=>w=Ee(v,"",w,{"--primary":s(),"--secondary":d()})),p(i,v)}var Rs=z('<div class="svelte-1j7dflg"></div>');function Us(i,t){let s=E(t,"primary",8,"#616161"),d=E(t,"secondary",8,"#e0e0e0");var v=Rs();let w;S(()=>w=Ee(v,"",w,{"--primary":s(),"--secondary":d()})),p(i,v)}var Vs=z('<div class="animated svelte-1kgeier"> </div>'),$s=z('<div class="status svelte-1kgeier"><!></div>'),Fs=z('<div class="indicator svelte-1kgeier"><!> <!></div>');function it(i,t){he(t,!1);const s=oe(),d=oe(),v=oe();let w=E(t,"toast",8);Ce(()=>(e(s),e(d),e(v),R(w())),()=>{(u=>{o(s,u.type),o(d,u.icon),o(v,u.iconTheme)})(w())}),Ke();var a=we(),f=W(a);{var g=u=>{var x=Vs(),N=c(x,!0);l(x),S(()=>F(N,e(d))),p(u,x)},C=(u,x)=>{{var N=h=>{var r=we(),P=W(r);dt(P,()=>e(d),(M,U)=>{U(M,{})}),p(h,r)},y=(h,r)=>{{var P=M=>{var U=Fs(),de=c(U);Us(de,nt(()=>e(v)));var be=b(de,2);{var Me=ge=>{var Ne=$s(),$=c(Ne);{var Q=V=>{Hs(V,nt(()=>e(v)))},ve=V=>{Ms(V,nt(()=>e(v)))};A($,V=>{e(s)==="error"?V(Q):V(ve,!1)})}l(Ne),p(ge,Ne)};A(be,ge=>{e(s)!=="loading"&&ge(Me)})}l(U),p(M,U)};A(h,M=>{e(s)!=="blank"&&M(P)},r)}};A(u,h=>{typeof e(d)<"u"?h(N):h(y,!1)},x)}};A(f,u=>{typeof e(d)=="string"?u(g):u(C,!1)})}p(i,a),_e()}var Ws=z("<div><!></div>");function Je(i,t){he(t,!1);let s=E(t,"toast",8);Ye();var d=Ws();fs(d,()=>({class:"message",...s().ariaProps}),void 0,"svelte-1nauejd");var v=c(d);{var w=f=>{var g=At();S(()=>F(g,(R(s()),me(()=>s().message)))),p(f,g)},a=f=>{var g=we(),C=W(g);dt(C,()=>s().message,(u,x)=>{x(u,{get toast(){return s()}})}),p(f,g)};A(v,f=>{R(s()),me(()=>typeof s().message=="string")?f(w):f(a,!1)})}l(d),p(i,d),_e()}var Bs=z("<!> <!>",1),js=z("<div><!></div>");function qs(i,t){he(t,!1);let s=E(t,"toast",8),d=E(t,"position",24,()=>{}),v=E(t,"style",8,""),w=E(t,"Component",24,()=>{}),a=oe(),f=oe();Ce(()=>(R(s()),R(d()),lt),()=>{const y=(s().position||d()||"top-center").includes("top");o(a,y?1:-1);const[h,r]=lt()?["fadeIn","fadeOut"]:["enter","exit"];o(f,s().visible?h:r)}),Ke(),Ye();var g=js();let C;var u=c(g);{var x=y=>{var h=we(),r=W(h);dt(r,w,(P,M)=>{M(P,{$$slots:{icon:(U,de)=>{it(U,{get toast(){return s()},slot:"icon"})},message:(U,de)=>{Je(U,{get toast(){return s()},slot:"message"})}}})}),p(y,h)},N=y=>{var h=we(),r=W(h);Ot(r,t,"default",{get ToastIcon(){return it},get ToastMessage(){return Je},get toast(){return s()}},P=>{var M=Bs(),U=W(M);it(U,{get toast(){return s()}});var de=b(U,2);Je(de,{get toast(){return s()}}),p(P,M)}),p(y,h)};A(u,y=>{w()?y(x):y(N,!1)})}l(g),S(()=>{Pe(g,1,`base ${R(s()),e(f),me(()=>s().height?e(f):"transparent")??""} ${R(s()),me(()=>s().className||"")??""}`,"svelte-ug60r4"),C=Ee(g,`${v()??""}; ${R(s()),me(()=>s().style)??""}`,C,{"--factor":e(a)})}),p(i,g),_e()}var Gs=z("<div><!></div>");function Js(i,t){he(t,!1);const s=oe(),d=oe(),v=oe(),w=oe();let a=E(t,"toast",8),f=E(t,"setHeight",8),g=oe();Xe(()=>{f()(e(g).getBoundingClientRect().height)}),Ce(()=>R(a()),()=>{var r;o(s,(r=a().position)!=null&&r.includes("top")?0:null)}),Ce(()=>R(a()),()=>{var r;o(d,(r=a().position)!=null&&r.includes("bottom")?0:null)}),Ce(()=>R(a()),()=>{var r;o(v,(r=a().position)!=null&&r.includes("top")?1:-1)}),Ce(()=>R(a()),()=>{var r,P,M;o(w,((r=a().position)==null?void 0:r.includes("center"))&&"center"||(((P=a().position)==null?void 0:P.includes("right"))||((M=a().position)==null?void 0:M.includes("end")))&&"flex-end"||null)}),Ke(),Ye();var C=Gs();let u,x;var N=c(C);{var y=r=>{Je(r,{get toast(){return a()}})},h=r=>{var P=we(),M=W(P);Ot(M,t,"default",{get toast(){return a()}},U=>{qs(U,{get toast(){return a()},get position(){return R(a()),me(()=>a().position)}})}),p(r,P)};A(N,r=>{R(a()),me(()=>a().type==="custom")?r(y):r(h,!1)})}l(C),ct(C,r=>o(g,r),()=>e(g)),S(r=>{u=Pe(C,1,"wrapper svelte-v01oml",null,u,r),x=Ee(C,"",x,{"--factor":e(v),"--offset":(R(a()),me(()=>a().offset)),top:e(s),bottom:e(d),"justify-content":e(w)})},[()=>({active:a().visible,transition:!lt()})],rs),p(i,C),_e()}var Xs=z('<div role="alert"></div>');function Ks(i,t){he(t,!1);const[s,d]=St(),v=()=>ze(x,"$toasts",s);let w=E(t,"reverseOrder",8,!1),a=E(t,"position",8,"top-center"),f=E(t,"toastOptions",24,()=>{}),g=E(t,"gutter",8,8),C=E(t,"containerStyle",24,()=>{}),u=E(t,"containerClassName",24,()=>{});const{toasts:x,handlers:N}=Ds(f());let y=oe();Ce(()=>(v(),R(a()),R(w()),R(g())),()=>{o(y,v().map(r=>({...r,position:r.position||a(),offset:N.calculateOffset(r,v(),{reverseOrder:w(),gutter:g(),defaultPosition:a()})})))}),Ke(),Ye();var h=Xs();Dt(h,5,()=>e(y),r=>r.id,(r,P)=>{Js(r,{get toast(){return e(P)},setHeight:M=>N.updateHeight(e(P).id,M)})}),l(h),S(()=>{Pe(h,1,`toaster ${(u()||"")??""}`,"svelte-1phplh9"),Ee(h,C())}),Te("mouseenter",h,function(...r){var P;(P=N.startPause)==null||P.apply(this,r)}),Te("mouseleave",h,function(...r){var P;(P=N.endPause)==null||P.apply(this,r)}),p(i,h),_e(),d()}const Ys=()=>{const i=Cs;return{page:{subscribe:i.page.subscribe},navigating:{subscribe:i.navigating.subscribe},updated:i.updated}},Qs={subscribe(i){return Ys().page.subscribe(i)}};function Nt(i,t,s){o(t,!e(t)),e(t)||s()}function Zs(){k.toggleRecomposeMode()}function ea(i,t){i.preventDefault(),o(t,!0)}function ta(i,t){o(t,!e(t))}function It(i,t,s,d,v){o(t,!e(t)),o(s,""),o(d,""),o(v,!1)}async function sa(){try{await bs(),k.resetState(),k.showToast("Signed out successfully","info"),Mt(ce+"/")}catch(i){console.error("Logout error:",i),k.showToast("Error during sign out","error")}}async function aa(i,t){if(!e(t)){k.showToast("No tree data available to copy","error");return}try{const s=JSON.stringify(e(t),null,2);await navigator.clipboard.writeText(s),k.showToast("Tree data copied to clipboard","success")}catch(s){console.error("Error copying tree:",s),k.showToast("Failed to copy tree data","error")}}var ra=z('<div class="breadcrumb-item loading-path svelte-1sz0n5w">Loading...</div>'),oa=(i,t)=>t(0,i),na=z('<a class="breadcrumb-item auth-root current svelte-1sz0n5w" tabindex="0"> </a>'),ia=z('<button class="breadcrumb-item loading-path svelte-1sz0n5w" tabindex="0" aria-label="Show login panel">Login</button>'),la=z('<div class="breadcrumb-separator svelte-1sz0n5w">/</div>'),ca=z('<!> <a tabindex="0"> </a>',1),da=z('<div class="loading-state svelte-1sz0n5w"><div class="spinner svelte-1sz0n5w"></div> <p class="svelte-1sz0n5w">Checking authentication...</p></div>'),va=(i,t,s)=>t(s()),ua=z('<button class="copy-pub-btn svelte-1sz0n5w" title="Click to copy your public key"><span class="pub-text svelte-1sz0n5w"> </span> <span class="copy-icon svelte-1sz0n5w">📋</span></button>'),fa=z('<div class="welcome-panel svelte-1sz0n5w"><div class="user-profile svelte-1sz0n5w"><div class="avatar large svelte-1sz0n5w"><img class="svelte-1sz0n5w"/></div> <div class="user-details svelte-1sz0n5w"><h3 class="svelte-1sz0n5w"> </h3> <p class="user-id svelte-1sz0n5w"> </p> <!></div></div> <div class="actions svelte-1sz0n5w"><button class="copy-tree-btn svelte-1sz0n5w"><span class="svelte-1sz0n5w">🌲📋</span></button> <button class="logout-btn svelte-1sz0n5w">Log Out</button> <button class="close-btn svelte-1sz0n5w">Close</button></div></div>'),ga=z('<div class="error-message svelte-1sz0n5w"> </div>'),pa=z('<div class="auth-message svelte-1sz0n5w"> </div>'),ma=z('<div class="form-group password-group svelte-1sz0n5w"><label for="confirmPassword" class="svelte-1sz0n5w">Confirm Password</label> <div class="password-input-container svelte-1sz0n5w"><input id="confirmPassword" name="confirmPassword" placeholder="Confirm password" autocomplete="new-password" required class="svelte-1sz0n5w"/></div></div> <div class="form-group checkbox-group svelte-1sz0n5w"><label class="checkbox-label svelte-1sz0n5w"><input type="checkbox" id="agreedToTerms" class="svelte-1sz0n5w"/> <span class="checkbox-text svelte-1sz0n5w">I agree to the <a target="_blank" class="terms-link svelte-1sz0n5w">Privacy Policy</a> and <a target="_blank" class="terms-link svelte-1sz0n5w">Terms of Use</a></span></label></div>',1),wa=z('<div class="spinner small svelte-1sz0n5w"></div> ',1),ha=z('Already have an account? <button type="button" class="text-link svelte-1sz0n5w">Sign in instead</button>',1),_a=z(`Don't have an account? <button type="button" class="text-link svelte-1sz0n5w">Create one now</button>`,1),ba=z('<div class="login-form svelte-1sz0n5w"><h3 class="svelte-1sz0n5w"> </h3> <p class="form-info svelte-1sz0n5w"> </p> <!> <!> <form class="svelte-1sz0n5w"><div class="form-group svelte-1sz0n5w"><label for="username" class="svelte-1sz0n5w">Username</label> <input type="text" id="username" name="username" placeholder="Enter username" autocomplete="username" required class="svelte-1sz0n5w"/></div> <div class="form-group password-group svelte-1sz0n5w"><label for="password" class="svelte-1sz0n5w">Password</label> <div class="password-input-container svelte-1sz0n5w"><input id="password" name="password" placeholder="Enter password" required class="svelte-1sz0n5w"/> <button type="button" class="toggle-password svelte-1sz0n5w"><span class="svelte-1sz0n5w"> </span></button></div></div> <!> <div class="actions svelte-1sz0n5w"><button type="submit"><!></button> <button type="button" class="cancel-btn svelte-1sz0n5w">Cancel</button></div> <div class="toggle-auth-mode svelte-1sz0n5w"><!></div></form></div>'),ya=z('<div class="login-panel svelte-1sz0n5w"><!></div>'),xa=z('<div class="header svelte-1sz0n5w"><div class="header-main svelte-1sz0n5w"><div class="node-name svelte-1sz0n5w"><div class="breadcrumbs svelte-1sz0n5w"><!></div></div> <div class="header-controls svelte-1sz0n5w"><button><span class="svelte-1sz0n5w">↕️</span></button> <a class="icon-button inventory-button svelte-1sz0n5w" title="View inventory"><span class="svelte-1sz0n5w">📊</span></a> <button class="icon-button add-button svelte-1sz0n5w" title="Add new node"><span class="svelte-1sz0n5w">➕</span></button> <button><span class="svelte-1sz0n5w">🗑️</span></button></div></div> <!></div>');function ka(i,t){he(t,!0);const[s,d]=St(),v=()=>ze(rt,"$userTree",s),w=()=>ze(Et,"$currentPath",s),a=()=>ze(_s,"$userpub",s),f=()=>ze(ps,"$username",s),g=()=>ze(ms,"$isAuthenticating",s),C=()=>ze(Qs,"$page",s);function u(n,m=14){return n.length<=m?n:n.slice(0,m-3)+"..."}async function x(n){try{await navigator.clipboard.writeText(n),k.showToast("Public key copied to clipboard","success")}catch(m){console.error("Failed to copy text: ",m),k.showToast("Failed to copy public key","error")}}let N=Y(0);function y(){ns(N),console.log("[UI FLOW] Header triggered update",e(N))}const h=re(v),r=re(w),P=re(f),M=re(g),U=re(()=>k.deleteMode),de=re(()=>k.recomposeMode),be=re(()=>(e(N),!e(h)||e(r).length===0?[]:e(r).map(n=>{const m=Pt(e(h),n);return{id:n,name:m?m.name:"Unknown"}})));Xe(()=>{const n=rt.subscribe(_=>{_&&(console.log("[UI FLOW] Header userTree updated, triggering UI update"),y())}),m=Et.subscribe(_=>{console.log("[UI FLOW] Header path updated:",_),y()});return()=>{n(),m()}});let Me=re(()=>C().url.pathname),ge=re(()=>e(Me).startsWith(ce)?e(Me).slice(ce.length):e(Me)),Ne=re(()=>e(ge)==="/"||e(ge)===""||!e(ge).startsWith("/inventory")&&!e(ge).startsWith("/contacts")),$=Y(!1),Q=Y(!1),ve=Y(""),V=Y(""),Oe=Y(""),B=Y(!1),j=Y(""),Ie=Y(""),Ae=Y(!1),ye=Y(!1);os(()=>{C().url.searchParams.get("error")&&(o(j,"Login failed. Please check your credentials."),o($,!0))});let vt=Y(null),Ve=Y(null);Xe(()=>{function n(m){e($)&&e(Ve)&&!e(Ve).contains(m.target)&&(m.target.closest(".header-controls")||o($,!1))}return document.addEventListener("mousedown",n),e(P)||setTimeout(()=>{o($,!0)},100),()=>{document.removeEventListener("mousedown",n)}});function $e(){o(ve,""),o(V,""),o(Oe,""),o(j,""),o(Ie,""),o(Ae,!1),o(B,!1),o(ye,!1)}function Ht(){if(!e(h)||e(r).length===0)return;const n=e(r)[e(r).length-1],m=structuredClone(e(h)),_=Pt(m,n);if(!_){k.showToast("Error creating node: Current node not found","error");return}const G=()=>{if(!_.children||_.children.length===0)return console.log("[UI FLOW] No siblings, setting new node to 100 points"),100;const te=_.children.reduce((q,Z)=>q+(Z.type==="NonRootNode"?Z.points:0),0),X=Math.max(1,te*.2);return console.log("[UI FLOW] Calculated points based on siblings:",X),X},J=`node_${Date.now()}_${Math.random().toString(36).substring(2,9)}`,L="New Node",ee=G();try{gs(_,J,L,ee),rt.set(m),y(),k.showToast("New node created","success"),setTimeout(()=>k.setNodeToEditMode(J),50)}catch(te){console.error("Error in handleAddNode:",te),k.showToast("Error creating node","error")}}function ut(n,m){if(m.preventDefault(),!e(P)){o($,!0);return}if(n===0&&e(be).length===1&&e(Ne)){o($,!e($));return}k.navigateToPathIndex(n),e(Ne)||Mt(ce+"/")}function Rt(){if(!e(ve)||!e(V))return o(j,"Please enter both username and password"),!1;if(e(B)){if(!e(ye))return o(j,"Please agree to the Privacy Policy and Terms of Use"),!1;if(e(V)!==e(Oe))return o(j,"Passwords do not match"),!1;if(e(V).length<8)return o(j,"Password must be at least 8 characters"),!1}return!0}async function Ut(n){if(n.preventDefault(),!!Rt()&&!e(Q)){o(j,""),o(Ie,""),o(Q,!0);try{e(B)?await $t():await Vt()}catch(m){console.error("Authentication error:",m),o(j,m instanceof Error?m.message:"Authentication error",!0)}finally{o(Q,!1)}}}async function Vt(){try{xs(e(ve).trim(),e(V)),o($,!1),$e(),k.showToast("Signed in successfully","success")}catch(n){console.error("Authentication error:",n),o(j,n instanceof Error?n.message:"Authentication error",!0)}}async function $t(){try{ys(e(ve).trim(),e(V)),o($,!1),$e(),k.showToast("Account created successfully!","success")}catch(n){console.error("Registration error:",n),o(j,n instanceof Error?n.message:"Registration error",!0)}}function Ft(n,m=null,_=32){if(m&&m.length>=87)try{return Ps({pub:m,size:_,round:!0,draw:"circles"})}catch(G){console.warn("Failed to generate gun-avatar:",G)}if(!n)return`data:image/svg+xml,${encodeURIComponent(`
				<svg xmlns="http://www.w3.org/2000/svg" width="${_}" height="${_}" viewBox="0 0 ${_} ${_}">
					<rect width="100%" height="100%" fill="#6b7280" rx="${_/4}" ry="${_/4}" />
					<text x="50%" y="50%" font-family="Arial" font-size="${_/2}px" fill="white" 
						text-anchor="middle" dominant-baseline="middle">
						?
					</text>
				</svg>
			`)}`;try{const G=Math.abs(n.split("").reduce((te,X)=>te+X.charCodeAt(0),0)%360),J=70,L=60,ee=n.charAt(0).toUpperCase();return`data:image/svg+xml,${encodeURIComponent(`
				<svg xmlns="http://www.w3.org/2000/svg" width="${_}" height="${_}" viewBox="0 0 ${_} ${_}">
					<rect width="100%" height="100%" fill="hsl(${G}, ${J}%, ${L}%)" rx="${_/4}" ry="${_/4}" />
					<text x="50%" y="50%" font-family="Arial" font-size="${_/2}px" fill="white" 
						text-anchor="middle" dominant-baseline="middle">
						${ee}
					</text>
				</svg>
			`)}`}catch(G){return console.error("Error generating avatar:",G),`data:image/svg+xml,${encodeURIComponent(`
				<svg xmlns="http://www.w3.org/2000/svg" width="${_}" height="${_}" viewBox="0 0 ${_} ${_}">
					<rect width="100%" height="100%" fill="#6b7280" rx="${_/4}" ry="${_/4}" />
					<text x="50%" y="50%" font-family="Arial" font-size="${_/2}px" fill="white" 
						text-anchor="middle" dominant-baseline="middle">
						!
					</text>
				</svg>
			`)}`}}var Fe=xa(),Qe=c(Fe),Ze=c(Qe),ft=c(Ze),Wt=c(ft);{var Bt=n=>{var m=ra();p(n,m)},jt=(n,m)=>{{var _=J=>{var L=na();L.__click=[oa,ut];var ee=c(L,!0);l(L),S(te=>{H(L,"href",`${ce??""}/`),H(L,"aria-label",f()),F(ee,te)},[()=>u(f())]),p(J,L)},G=(J,L)=>{{var ee=X=>{var q=ia();q.__click=[ea,$],p(X,q)},te=X=>{var q=we(),Z=W(q);Dt(Z,17,()=>e(be),ws,(ue,se,ae)=>{var xe=ca(),ne=W(xe);{var He=D=>{var ie=la();p(D,ie)};A(ne,D=>{ae>0&&D(He)})}var O=b(ne,2);let Le;O.__click=D=>{ut(ae,D)};var ke=c(O,!0);l(O),S((D,ie)=>{H(O,"href",`${ce??""}/`),Le=Pe(O,1,"breadcrumb-item svelte-1sz0n5w",null,Le,D),H(O,"data-node-id",e(se).id),H(O,"aria-label",e(se).name),H(O,"title",e(se).name),F(ke,ie)},[()=>({current:ae===e(be).length-1,"auth-root":ae===0,"drop-target":k.isDragging}),()=>u(e(se).name)]),Te("dragover",O,D=>{D.preventDefault()}),Te("drop",O,D=>{D.preventDefault(),k.isDragging&&k.draggedNodeId&&(k.handleNodeReorder(k.draggedNodeId,e(se).id),k.endDrag())}),Te("pointerenter",O,D=>{k.isDragging&&(D.currentTarget.style.backgroundColor="rgba(33, 150, 243, 0.2)")}),Te("pointerleave",O,D=>{k.isDragging&&(D.currentTarget.style.backgroundColor="rgba(33, 150, 243, 0.1)")}),p(ue,xe)}),p(X,q)};A(J,X=>{e(be).length===0?X(ee):X(te,!1)},L)}};A(n,J=>{e(be).length===0&&f()?J(_):J(G,!1)},m)}};A(Wt,n=>{e(M)?n(Bt):n(jt,!1)})}l(ft),l(Ze);var gt=b(Ze,2),We=c(gt);let pt;We.__click=[Zs];var mt=b(We,2),wt=b(mt,2);wt.__click=Ht;var et=b(wt,2);let ht;et.__click=function(...n){var m;(m=k.toggleDeleteMode)==null||m.apply(this,n)},l(gt),l(Qe);var qt=b(Qe,2);{var Gt=n=>{var m=ya(),_=c(m);{var G=L=>{var ee=da();p(L,ee)},J=(L,ee)=>{{var te=q=>{var Z=fa(),ue=c(Z),se=c(ue),ae=c(se);l(se);var xe=b(se,2),ne=c(xe),He=c(ne);l(ne);var O=b(ne,2),Le=c(O);l(O);var ke=b(O,2);{var D=le=>{var fe=ua();fe.__click=[va,x,a];var Se=c(fe),Be=c(Se);l(Se),is(2),l(fe),S(tt=>F(Be,`🔑 ${tt??""}`),[()=>u(a(),20)]),p(le,fe)};A(ke,le=>{a()&&le(D)})}l(xe),l(ue);var ie=b(ue,2),De=c(ie);De.__click=[aa,h];var Re=b(De,2);Re.__click=[sa];var pe=b(Re,2);pe.__click=[Nt,$,$e],l(ie),l(Z),S((le,fe,Se)=>{H(ae,"src",le),H(ae,"alt",f()),H(ne,"title",f()),F(He,`Welcome, ${fe??""}`),H(O,"title","@"+(f()||"anonymous")),F(Le,`@${Se??""}`)},[()=>Ft(f(),a(),60),()=>u(f(),15),()=>u(f()||"anonymous",15)]),p(q,Z)},X=q=>{var Z=ba(),ue=c(Z),se=c(ue,!0);l(ue);var ae=b(ue,2),xe=c(ae,!0);l(ae);var ne=b(ae,2);{var He=T=>{var I=ga(),K=c(I,!0);l(I),S(()=>F(K,e(j))),p(T,I)};A(ne,T=>{e(j)&&T(He)})}var O=b(ne,2);{var Le=T=>{var I=pa(),K=c(I,!0);l(I),S(()=>F(K,e(Ie))),p(T,I)};A(O,T=>{e(Ie)&&T(Le)})}var ke=b(O,2),D=c(ke),ie=b(c(D),2);Ge(ie),l(D);var De=b(D,2),Re=b(c(De),2),pe=c(Re);Ge(pe);var le=b(pe,2);le.__click=[ta,Ae];var fe=c(le),Se=c(fe,!0);l(fe),l(le),l(Re),l(De);var Be=b(De,2);{var tt=T=>{var I=ma(),K=W(I),yt=b(c(K),2),je=c(yt);Ge(je),l(yt),l(K);var xt=b(K,2),kt=c(xt),qe=c(kt);Ge(qe);var zt=b(qe,2),Tt=b(c(zt)),es=b(Tt,2);l(zt),l(kt),l(xt),S(()=>{H(je,"type",e(Ae)?"text":"password"),je.disabled=e(Q),qe.disabled=e(Q),H(Tt,"href",`${ce??""}/privacy`),H(es,"href",`${ce??""}/terms`)}),ot(je,()=>e(Oe),at=>o(Oe,at)),ks(qe,()=>e(ye),at=>o(ye,at)),p(T,I)};A(Be,T=>{e(B)&&T(tt)})}var st=b(Be,2),Ue=c(st),Jt=c(Ue);{var Xt=T=>{var I=wa(),K=b(W(I));S(()=>F(K,` ${e(B)?"Creating account...":"Signing in..."}`)),p(T,I)},Kt=T=>{var I=At();S(()=>F(I,e(B)?"Create Account":"Sign In")),p(T,I)};A(Jt,T=>{e(Q)?T(Xt):T(Kt,!1)})}l(Ue);var _t=b(Ue,2);_t.__click=[Nt,$,$e],l(st);var bt=b(st,2),Yt=c(bt);{var Qt=T=>{var I=ha(),K=b(W(I));K.__click=[It,B,j,Ie,ye],p(T,I)},Zt=T=>{var I=_a(),K=b(W(I));K.__click=[It,B,j,Ie,ye],p(T,I)};A(Yt,T=>{e(B)?T(Qt):T(Zt,!1)})}l(bt),l(ke),l(Z),S(()=>{F(se,e(B)?"Create Account":"Sign In"),F(xe,e(B)?"Enter your details to create a new account":"Enter your details to sign in"),ie.disabled=e(Q),H(pe,"type",e(Ae)?"text":"password"),pe.disabled=e(Q),H(pe,"autocomplete",e(B)?"new-password":"current-password"),H(le,"title",e(Ae)?"Hide password":"Show password"),F(Se,e(Ae)?"🙈":"🐵"),Pe(Ue,1,hs(e(B)?"signup-btn":"login-btn"),"svelte-1sz0n5w"),Ue.disabled=e(Q)||!e(ve)||!e(V)||e(B)&&(!e(Oe)||!e(ye)),_t.disabled=e(Q)}),Te("submit",ke,Ut),ot(ie,()=>e(ve),T=>o(ve,T)),ot(pe,()=>e(V),T=>o(V,T)),p(q,Z)};A(L,q=>{f()?q(te):q(X,!1)},ee)}};A(_,L=>{e(M)?L(G):L(J,!1)})}l(m),ct(m,L=>o(Ve,L),()=>e(Ve)),p(n,m)};A(qt,n=>{e($)&&n(Gt)})}l(Fe),ct(Fe,n=>o(vt,n),()=>e(vt)),S((n,m)=>{pt=Pe(We,1,"icon-button recompose-button svelte-1sz0n5w",null,pt,n),H(We,"title",e(de)?"Click to turn off recompose mode":"Toggle recompose mode"),H(mt,"href",`${ce??""}/inventory`),ht=Pe(et,1,"icon-button delete-button svelte-1sz0n5w",null,ht,m),H(et,"title",e(U)?"Click to turn off delete mode":"Toggle delete mode")},[()=>({"recompose-active":e(de)}),()=>({"delete-active":e(U)})]),p(i,Fe),_e(),d()}Lt(["click"]);Lt(["click"]);var za=z('<div class="dragged-node svelte-wa8sqt"><div class="dragged-node-content svelte-wa8sqt"> </div></div>');function Ta(i,t){he(t,!0);let s=E(t,"show",3,!1),d=E(t,"nodeName",3,""),v=E(t,"nodeColor",3,""),w=E(t,"x",3,0),a=E(t,"y",3,0);const f=re(()=>v()||zs(d()));var g=we(),C=W(g);{var u=x=>{var N=za(),y=c(N),h=c(y,!0);l(y),l(N),S(r=>{Ee(N,`
			left: ${w()??""}px;
			top: ${a()??""}px;
			background-color: ${e(f)??""};
		`),F(h,r)},[()=>d().charAt(0).toUpperCase()]),p(x,N)};A(C,x=>{s()&&x(u)})}p(i,g),_e()}var Ca=z('<link rel="manifest"/>'),Pa=z('<main class="svelte-teo403"><div class="app-header svelte-teo403"><!></div> <div class="app-content svelte-teo403"><!></div></main> <!> <!>',1);function Ua(i,t){he(t,!0),Xe(()=>{"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(y=>{if(console.log("Service worker registered successfully:",y),"Notification"in window&&Notification.permission==="default")return Notification.requestPermission()}).catch(y=>{console.error("Service worker registration failed:",y)});function u(y){if(y.key==="Escape"){if(k.editMode)return;const h=document.activeElement;h&&(h.tagName==="INPUT"||h.tagName==="TEXTAREA"||h.isContentEditable||h.closest(".node-edit-input"))||(y.preventDefault(),k.zoomOut())}}function x(){if(!window.visualViewport&&!window.innerHeight)return;let y=0;window.visualViewport?y=window.innerHeight-window.visualViewport.height:window.screen&&window.screen.height&&(y=Math.max(0,window.screen.height-window.innerHeight-100)),y>0?(document.documentElement.style.setProperty("--keyboard-height",`${y}px`),document.documentElement.style.setProperty("-webkit-keyboard-height",`${y}px`),document.documentElement.style.setProperty("-moz-keyboard-height",`${y}px`)):(document.documentElement.style.setProperty("--keyboard-height","0px"),document.documentElement.style.setProperty("-webkit-keyboard-height","0px"),document.documentElement.style.setProperty("-moz-keyboard-height","0px"))}const N="visualViewport"in window;return N&&window.visualViewport?(window.visualViewport.addEventListener("resize",x),window.visualViewport.addEventListener("scroll",x)):(window.addEventListener("resize",x),window.addEventListener("orientationchange",()=>{setTimeout(x,100)})),x(),document.addEventListener("keydown",u),()=>{document.removeEventListener("keydown",u),N&&window.visualViewport&&(window.visualViewport.removeEventListener("resize",x),window.visualViewport.removeEventListener("scroll",x))}});var s=Pa();ls(u=>{var x=Ca();S(()=>H(x,"href",`${ce??""}/manifest.json`)),p(u,x)});var d=W(s),v=c(d),w=c(v);ka(w,{}),l(v);var a=b(v,2),f=c(a);Ts(f,()=>t.children),l(a),l(d);var g=b(d,2);Ks(g,{position:"bottom-center"});var C=b(g,2);Ta(C,{get show(){return k.isDragging},get nodeName(){return k.draggedNodeName},get nodeColor(){return k.draggedNodeColor},get x(){return k.dragX},get y(){return k.dragY}}),p(i,s),_e()}export{Ua as component,Ra as universal};
